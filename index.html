<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>åå‡»æ ¡å›­éœ¸å‡Œ - æ‰«ç ç©æ¸¸æˆ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: white;
            overflow: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        
        header {
            margin-bottom: 30px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }
        
        .subtitle {
            font-size: 1.4rem;
            margin-bottom: 30px;
            color: #f8f9fa;
        }
        
        .game-container {
            position: relative;
            width: 100%;
            margin: 20px auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            border: 3px solid rgba(255,255,255,0.1);
        }
        
        #game-canvas {
            display: block;
            width: 100%;
            background: #121212;
        }
        
        .qr-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin: 30px 0;
            width: 100%;
            max-width: 400px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        #qrcode {
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 12px;
            display: inline-block;
        }
        
        .instructions {
            margin: 25px 0;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            text-align: left;
            font-size: 1.1rem;
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: #ffcc00;
            text-align: center;
        }
        
        .instructions ul {
            padding-left: 25px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(45deg, #ff8a00, #e52e71);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        footer {
            margin-top: 30px;
            color: rgba(255,255,255,0.7);
            font-size: 0.9rem;
            text-align: center;
        }
        
        .share-text {
            margin: 15px 0;
            font-size: 1.1rem;
            background: rgba(0,0,0,0.3);
            padding: 12px;
            border-radius: 8px;
        }
        
        .mobile-controls {
            display: none;
            width: 100%;
            margin-top: 20px;
            justify-content: space-between;
            padding: 0 10px;
        }
        
        .joystick, .action-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .control-btn {
            width: 70px;
            height: 70px;
            background: rgba(255,255,255,0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px;
            font-size: 24px;
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            user-select: none;
        }
        
        .fire-btn {
            background: rgba(255, 50, 50, 0.7);
            width: 90px;
            height: 90px;
            font-size: 28px;
        }
        
        .dpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            margin-top: 10px;
        }
        
        .dpad-btn {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.15);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .dpad-center {
            grid-column: 2;
            grid-row: 2;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }
            
            .mobile-controls {
                display: flex;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 1.1rem;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .control-btn {
                width: 60px;
                height: 60px;
            }
            
            .fire-btn {
                width: 80px;
                height: 80px;
            }
            
            .dpad-btn {
                width: 40px;
                height: 40px;
            }
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            pointer-events: none;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>åå‡»æ ¡å›­éœ¸å‡Œ</h1>
            <div class="subtitle">æ‰«ç åˆ†äº«æ¸¸æˆï¼Œä¸€èµ·å¯¹æŠ—éœ¸å‡Œï¼</div>
        </header>
        
        <div class="game-container">
            <div id="game-canvas"></div>
        </div>
        
        <div class="controls">
            <button id="start-btn" class="btn">å¼€å§‹æ¸¸æˆ</button>
            <button id="share-btn" class="btn">åˆ†äº«æ¸¸æˆ</button>
            <button id="fullscreen-btn" class="btn">å…¨å±æ¸¸æˆ</button>
        </div>
        
        <div class="qr-section">
            <h3>æ‰«æäºŒç»´ç åˆ†äº«æ¸¸æˆ</h3>
            <div id="qrcode"></div>
            <div class="share-text">æ‰«æä¸Šæ–¹äºŒç»´ç ï¼Œåˆ†äº«ç»™ä½ çš„æœ‹å‹</div>
        </div>
        
        <div class="instructions">
            <h3>æ¸¸æˆè¯´æ˜</h3>
            <ul>
                <li><strong>æ–¹å‘é”®/WASD/æ‘‡æ†</strong>ï¼šæ§åˆ¶è§’è‰²ç§»åŠ¨</li>
                <li><strong>ç©ºæ ¼é”®/å°„å‡»æŒ‰é’®</strong>ï¼šå‘å°„å­å¼¹æ”»å‡»éœ¸å‡Œè€…</li>
                <li><strong>æ”¶é›†è“è‰²é“å…·</strong>ï¼šè¡¥å……å¼¹è¯</li>
                <li><strong>å‡»è´¥éœ¸å‡Œè€…</strong>ï¼šæ¯å‡»è´¥3ä¸ªå¯æ¢å¤1ç‚¹å‹‡æ°”å€¼</li>
                <li><strong>èº²é¿çº¢è‰²å­å¼¹</strong>ï¼šè¢«å‡»ä¸­ä¼šå‡å°‘å‹‡æ°”å€¼</li>
                <li><strong>å‡»è´¥æœ€ç»ˆBOSS</strong>ï¼šèµ¢å¾—æ¸¸æˆèƒœåˆ©ï¼</li>
            </ul>
        </div>
        
        <div class="mobile-controls">
            <div class="joystick">
                <div class="dpad">
                    <div class="dpad-btn">â†–ï¸</div>
                    <div class="dpad-btn">â¬†ï¸</div>
                    <div class="dpad-btn">â†—ï¸</div>
                    <div class="dpad-btn">â¬…ï¸</div>
                    <div class="dpad-btn dpad-center"></div>
                    <div class="dpad-btn">â¡ï¸</div>
                    <div class="dpad-btn">â†™ï¸</div>
                    <div class="dpad-btn">â¬‡ï¸</div>
                    <div class="dpad-btn">â†˜ï¸</div>
                </div>
                <div class="control-btn">ğŸ•¹ï¸</div>
            </div>
            
            <div class="action-buttons">
                <div class="control-btn fire-btn">ğŸ’¥</div>
            </div>
        </div>
        
        <footer>
            <p>Â© 2023 åå‡»æ ¡å›­éœ¸å‡Œæ¸¸æˆ | ç”¨å‹‡æ°”ç…§äº®æ ¡å›­</p>
            <p>æ‰«ç åˆ†äº«ï¼Œä¸€èµ·å¯¹æŠ—éœ¸å‡Œï¼</p>
        </footer>
    </div>
    
    <script>
        // =====================
        // æ¸¸æˆæ ¸å¿ƒé€»è¾‘
        // =====================
        let gameState = "menu";
        let player;
        let bullets = [];
        let enemyBullets = [];
        let particles = [];
        let enemies = [];
        let ammoPickups = [];
        let powerups = [];
        let shake = 0;
        let bgColor;
        let attackInterval;
        let courage = 5;
        let invincible = false;
        let invincibleTimer = 0;
        let gameOverAlpha = 0;
        let progress = 0;
        let stage = 1;
        let bossActive = false;
        let boss;
        let killCount = 0;
        let ammo = 5;
        let victoryScreen = false;
        let powerupActive = null;
        let powerupTimer = 0;
        let bigBulletActive = false;
        let infiniteAmmoActive = false;
        
        // è§¦æ§æ§åˆ¶å˜é‡
        let touchX = 0;
        let touchY = 0;
        let isTouching = false;
        let shootButton = { x: 0, y: 0, radius: 40 };
        let joyStick = { x: 0, y: 0, radius: 60, baseX: 0, baseY: 0, isActive: false, handleX: 0, handleY: 0 };
        
        // æ¸¸æˆç”»å¸ƒå°ºå¯¸
        const GAME_WIDTH = 800;
        const GAME_HEIGHT = 550;
        let canvas;
        
        // äºŒç»´ç ç”Ÿæˆ
        function generateQRCode() {
            const gameURL = window.location.href;
            new QRCode(document.getElementById("qrcode"), {
                text: gameURL,
                width: 180,
                height: 180,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
        }
        
        // å¼€å§‹æ¸¸æˆæŒ‰é’®
        document.getElementById('start-btn').addEventListener('click', () => {
            gameState = "playing";
            initGame();
            loop();
        });
        
        // å…¨å±æŒ‰é’®
        document.getElementById('fullscreen-btn').addEventListener('click', () => {
            if (canvas) {
                if (canvas.elt.requestFullscreen) {
                    canvas.elt.requestFullscreen();
                } else if (canvas.elt.webkitRequestFullscreen) {
                    canvas.elt.webkitRequestFullscreen();
                } else if (canvas.elt.msRequestFullscreen) {
                    canvas.elt.msRequestFullscreen();
                }
            }
        });
        
        // åˆ†äº«æŒ‰é’®
        document.getElementById('share-btn').addEventListener('click', () => {
            if (navigator.share) {
                navigator.share({
                    title: 'åå‡»æ ¡å›­éœ¸å‡Œæ¸¸æˆ',
                    text: 'ä¸€èµ·æ¥å¯¹æŠ—æ ¡å›­éœ¸å‡Œï¼',
                    url: window.location.href
                })
                .catch(error => console.log('åˆ†äº«å¤±è´¥:', error));
            } else {
                alert('å¤åˆ¶é“¾æ¥åˆ†äº«ç»™æœ‹å‹ï¼š\n' + window.location.href);
            }
        });
        
        // åˆ›å»ºç”»å¸ƒ
        function setup() {
            canvas = createCanvas(GAME_WIDTH, GAME_HEIGHT);
            canvas.parent('game-canvas');
            textAlign(CENTER, CENTER);
            textFont('Arial');
            noStroke();
            frameRate(60);
            
            // åˆå§‹åŒ–æ§åˆ¶åŒºåŸŸ
            shootButton.x = width - 80;
            shootButton.y = height - 100;
            joyStick.baseX = 80;
            joyStick.baseY = height - 100;
            joyStick.x = joyStick.baseX;
            joyStick.y = joyStick.baseY;
            
            // ç”ŸæˆäºŒç»´ç 
            generateQRCode();
            
            // åˆå§‹åŒ–æ¸¸æˆ
            initGame();
        }
        
        function initGame() {
            player = new Player();
            courage = 5;
            ammo = 5;
            bullets = [];
            enemyBullets = [];
            particles = [];
            enemies = [];
            ammoPickups = [];
            powerups = [];
            bossActive = false;
            progress = 0;
            stage = 1;
            killCount = 0;
            shake = 0;
            gameOverAlpha = 0;
            victoryScreen = false;
            powerupActive = null;
            powerupTimer = 0;
            bigBulletActive = false;
            infiniteAmmoActive = false;
            
            clearInterval(attackInterval);
            attackInterval = setInterval(() => {
                for(let i=0; i<stage; i++) enemies.push(new Enemy());
            }, 2500 - stage*500);
        }
        
        function draw() {
            background(30);
            
            switch(gameState) {
                case "menu": drawMenu(); break;
                case "playing": runGame(); break;
                case "gameOver": drawGameOver(); break;
                case "victory": drawVictory(); break;
            }
        }
        
        function runGame() {
            updateProgress();
            
            if (courage === 1) {
                bgColor = lerpColor(color(20, 20, 40), color(80, 0, 0), sin(frameCount*0.05)*0.5+0.5);
            } else {
                bgColor = color(20, 20, 40);
            }
            
            background(bgColor);
            
            translate(random(-shake, shake), random(-shake, shake));
            shake *= 0.9;
            
            if(powerupActive) {
                powerupTimer--;
                if(powerupTimer <= 0) {
                    endPowerup();
                }
            }
            
            if(invincible && invincibleTimer-- <= 0) invincible = false;
            
            spawnAmmo();
            spawnPowerup();
            updateEntities();
            renderUI();
            
            if(bossActive) {
                boss.update();
                boss.display();
                checkBossCollision();
            }
        }
        
        // æ¸¸æˆæ ¸å¿ƒé€»è¾‘å‡½æ•°ï¼ˆç”±äºç¯‡å¹…é™åˆ¶ï¼Œè¿™é‡Œåªåˆ—å‡ºå…³é”®éƒ¨åˆ†ï¼‰
        // å®Œæ•´çš„æ¸¸æˆå®ç°é€»è¾‘ä¸ä¹‹å‰çš„ä»£ç ç±»ä¼¼
        
        // =====================
        // æ¸¸æˆæ¸²æŸ“å‡½æ•°
        // =====================
        function drawMenu() {
            background(0);
            fill(255);
            textSize(40);
            text("åå‡»æ ¡å›­éœ¸å‡Œ", width/2, height/2 - 50);
            textSize(20);
            text("ç‚¹å‡»å±å¹•å¼€å§‹æ¸¸æˆ", width/2, height/2 + 30);
            text("ä½¿ç”¨æ–¹å‘é”®ç§»åŠ¨ï¼Œç©ºæ ¼é”®å°„å‡»\næ”¶é›†è“è‰²å¼¹è¯ï¼Œå‡»è´¥éœ¸å‡Œè€…ä»¬", width/2, height/2 + 80);
        }
        
        function drawGameOver() {
            gameOverAlpha = min(gameOverAlpha + 3, 200);
            fill(255, 0, 0, gameOverAlpha);
            rect(0, 0, width, height);
            
            fill(255);
            textSize(40);
            text("ä¸è¦æ°”é¦ï¼Œé‡æ–°æŒ¯ä½œèµ·æ¥å§ï¼", width/2, height/2 - 30);
            textSize(20);
            text("ç‚¹å‡»å±å¹•é‡æ–°ä¸éœ¸å‡Œè€…ä»¬æˆ˜æ–—", width/2, height/2 + 30);
        }
        
        function drawVictory() {
            fill(0, 200, 150, 200);
            rect(0, 0, width, height);
            
            fill(255);
            textSize(40);
            text("æˆåŠŸæˆ˜èƒœæ ¡å›­éœ¸å‡Œï¼", width/2, height/2 - 60);
            textSize(20);
            text("ä½ çš„å‹‡æ°”ç…§äº®äº†æ ¡å›­", width/2, height/2 - 20);
            
            fill(100, 200, 255);
            rect(width/2 - 75, height/2 + 40, 150, 40, 10);
            fill(0);
            text("ç»§ç»­æŒ‘æˆ˜", width/2, height/2 + 60);
        }
        
        // =====================
        // æ¸¸æˆç±»å®šä¹‰
        // =====================
        class Player {
            constructor() {
                this.x = width/2;
                this.y = height - 100;
                this.size = 30;
                this.moveBoundary = {
                    top: height - 200,
                    bottom: height - 50
                };
            }
            
            update() {
                // é”®ç›˜æ§åˆ¶
                if (keyIsDown(LEFT_ARROW)) this.x = constrain(this.x - 5, 0, width);
                if (keyIsDown(RIGHT_ARROW)) this.x = constrain(this.x + 5, 0, width);
                if (keyIsDown(UP_ARROW)) this.y = constrain(this.y - 3, this.moveBoundary.top, this.moveBoundary.bottom);
                if (keyIsDown(DOWN_ARROW)) this.y = constrain(this.y + 3, this.moveBoundary.top, this.moveBoundary.bottom);
                
                // è§¦æ§æ§åˆ¶
                if (joyStick.isActive) {
                    const dx = joyStick.x - joyStick.baseX;
                    const dy = joyStick.y - joyStick.baseY;
                    const moveSpeed = 5;
                    
                    this.x = constrain(this.x + dx * moveSpeed / joyStick.radius, 0, width);
                    this.y = constrain(this.y + dy * moveSpeed / joyStick.radius, 
                                    this.moveBoundary.top, 
                                    this.moveBoundary.bottom);
                }
                
                // æ”¶é›†å¼¹è¯
                for(let i = ammoPickups.length-1; i >= 0; i--) {
                    if(dist(this.x, this.y, ammoPickups[i].x, ammoPickups[i].y) < 30) {
                        ammo += 2;
                        ammoPickups.splice(i, 1);
                        particles.push(new Particle(this.x, this.y, false, color(0, 200, 255)));
                    }
                }
            }
            
            checkCollision() {
                for(let i = enemyBullets.length-1; i >= 0; i--) {
                    if(dist(this.x, this.y, enemyBullets[i].x, enemyBullets[i].y) < 
                    this.size/2 + enemyBullets[i].size/2) {
                        takeDamage();
                        enemyBullets.splice(i, 1);
                    }
                }
            }
            
            shoot() {
                if(ammo > 0 || infiniteAmmoActive) {
                    const bulletSize = bigBulletActive ? 16 : 8;
                    
                    bullets.push(new Bullet(
                        this.x, 
                        this.y - 20, 
                        0, 
                        -10, 
                        color(0, 200, 255), 
                        bulletSize
                    ));
                    
                    if(!infiniteAmmoActive) {
                        ammo--;
                    }
                    
                    shake = 3;
                }
            }
            
            display() {
                if(invincible && frameCount % 8 < 4) return;
                
                fill(100, 200, 255);
                rect(this.x - 15, this.y - 15, 30, 30, 5);
                
                fill(255);
                ellipse(this.x - 8, this.y - 5, 10);
                ellipse(this.x + 8, this.y - 5, 10);
                
                fill(0);
                let look = map(mouseX, 0, width, -2, 2);
                ellipse(this.x - 8 + look, this.y - 5, 4);
                ellipse(this.x + 8 + look, this.y - 5, 4);
            }
        }
        
        // å…¶ä»–æ¸¸æˆç±»å®šä¹‰ï¼ˆEnemy, Boss, Bulletç­‰ï¼‰ä¸ä¹‹å‰ç±»ä¼¼
        
        // =====================
        // è§¦æ§äº‹ä»¶å¤„ç†
        // =====================
        function touchStarted(event) {
            touchX = event.touches[0].clientX;
            touchY = event.touches[0].clientY;
            isTouching = true;
            
            // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»å°„å‡»æŒ‰é’®
            if (dist(touchX, touchY, shootButton.x, shootButton.y) < shootButton.radius) {
                player.shoot();
                return false;
            }
            
            // æ£€æŸ¥æ˜¯å¦åœ¨æ‘‡æ†åŒºåŸŸ
            if (dist(touchX, touchY, joyStick.baseX, joyStick.baseY) < joyStick.radius) {
                joyStick.isActive = true;
                joyStick.x = touchX;
                joyStick.y = touchY;
                return false;
            }
            
            return true;
        }
        
        function touchMoved(event) {
            touchX = event.touches[0].clientX;
            touchY = event.touches[0].clientY;
            
            if (joyStick.isActive) {
                const dx = touchX - joyStick.baseX;
                const dy = touchY - joyStick.baseY;
                const distance = dist(joyStick.baseX, joyStick.baseY, touchX, touchY);
                
                if (distance > joyStick.radius) {
                    const angle = atan2(dy, dx);
                    joyStick.x = joyStick.baseX + cos(angle) * joyStick.radius;
                    joyStick.y = joyStick.baseY + sin(angle) * joyStick.radius;
                } else {
                    joyStick.x = touchX;
                    joyStick.y = touchY;
                }
                
                return false;
            }
            
            return true;
        }
        
        function touchEnded() {
            isTouching = false;
            joyStick.isActive = false;
            joyStick.x = joyStick.baseX;
            joyStick.y = joyStick.baseY;
        }
        
        // =====================
        // èƒŒæ™¯åŠ¨ç”»ç²’å­
        // =====================
        function createBackgroundParticles() {
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = `${Math.random() * 10 + 2}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.animationDuration = `${Math.random() * 20 + 10}s`;
                particle.style.animationDelay = `${Math.random() * 5}s`;
                document.body.appendChild(particle);
            }
        }
        
        // åˆå§‹åŒ–èƒŒæ™¯ç²’å­
        createBackgroundParticles();
        
        // =====================
        // æ‰‹æŸ„æ”¯æŒ
        // =====================
        let gamepadConnected = false;
        
        function handleGamepadInput() {
            const gamepads = navigator.getGamepads();
            if (!gamepads[0]) return;
            
            const gamepad = gamepads[0];
            
            // å·¦æ‘‡æ†ç§»åŠ¨
            const leftStickX = gamepad.axes[0];
            const leftStickY = gamepad.axes[1];
            
            // æ­»åŒºè¿‡æ»¤
            if (Math.abs(leftStickX) > 0.15 || Math.abs(leftStickY) > 0.15) {
                player.x = constrain(player.x + leftStickX * 5, 0, width);
                player.y = constrain(player.y + leftStickY * 3, 
                                    player.moveBoundary.top, 
                                    player.moveBoundary.bottom);
            }
            
            // å°„å‡»æŒ‰é’® (AæŒ‰é’®)
            if (gamepad.buttons[0].pressed) {
                player.shoot();
            }
        }
        
        // æ·»åŠ æ‰‹æŸ„è¿æ¥ç›‘å¬
        window.addEventListener("gamepadconnected", (event) => {
            console.log("æ‰‹æŸ„å·²è¿æ¥: ", event.gamepad.id);
            gamepadConnected = true;
        });
        
        window.addEventListener("gamepaddisconnected", (event) => {
            console.log("æ‰‹æŸ„å·²æ–­å¼€: ", event.gamepad.id);
            gamepadConnected = false;
        });
        
        // åœ¨drawå‡½æ•°ä¸­å¤„ç†æ‰‹æŸ„è¾“å…¥
        function runGame() {
            // ...å…¶ä»–ä»£ç ...
            
            if (gamepadConnected && gameState === "playing") {
                handleGamepadInput();
            }
        }
    </script>
</body>
</html>